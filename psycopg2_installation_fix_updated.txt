# ModEcon Matrix System - psycopg2 Installation Fix (Updated)

## Problem Description
When running the `install_packages.bat` script, the following error occurred:

```
Error: pg_config executable not found.

pg_config is required to build psycopg2 from source. Please add the directory
containing pg_config to the $PATH or specify the full executable path with the
option:

    python setup.py build_ext --pg-config /path/to/pg_config build ...

or with the pg_config option in 'setup.cfg'.

If you prefer to avoid building psycopg2 from source, please install the PyPI
'psycopg2-binary' package instead.
```

## Root Cause
The error occurred because the installation was trying to build psycopg2 from source, which requires the PostgreSQL development tools (specifically pg_config) to be installed and available in the PATH. Most users don't have these development tools installed by default.

Additionally, the specified version (2.9.3) is no longer available as a binary package for newer Python versions.

## Solution Implemented
Three changes were made to fix this issue:

1. Modified `install_packages.bat` to explicitly install psycopg2-binary with the latest version (2.9.10) and using the `--only-binary` option to force using the pre-compiled binary:
   ```batch
   echo Installing psycopg2-binary package...
   pip install --only-binary=:all: psycopg2-binary==2.9.10
   echo Installing remaining packages from requirements.txt...
   pip install -r requirements.txt
   ```

2. Updated `backend/requirements.txt` to use the latest version of psycopg2-binary:
   ```
   psycopg2-binary==2.9.10  # PostgreSQL adapter
   ```

3. Updated `test_installation.py` to check for 'psycopg2' instead of 'psycopg2_binary':
   ```python
   # Python packages to check
   python_packages = [
       'flask',
       'psycopg2',  # We install psycopg2-binary but import it as psycopg2
       'clickhouse_driver',
       # ...
   ]
   ```

## Verification
After making these changes, the installation completes without errors for the psycopg2 package. The `test_installation.py` script verifies that psycopg2 is correctly installed.

## Future Considerations
If you need to modify the installation process in the future:
- Always use psycopg2-binary instead of psycopg2 to avoid compilation issues
- Use the `--only-binary` option to ensure pre-compiled binaries are used
- Keep the version pinned (e.g., ==2.9.10) to ensure compatibility
- If PostgreSQL version changes, you may need to update the psycopg2-binary version accordingly
- Remember that when importing in Python code, you still use `import psycopg2` even though the package installed is psycopg2-binary